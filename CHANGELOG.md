# Changelog

## [2.0.0] - 2025-01-XX

### Добавлено
- **Новый режим фильтрации по дате** (`--date-filter`)
  - Запрос даты у пользователя при запуске
  - Фильтрация проблем по дате активности
  - Обработка только проблем, активных в указанную дату
  - Создание одного временного окна для указанной даты

- **Сохранение результатов в Excel** (`--save-to-excel`)
  - Сохранение результатов в исходный Excel файл
  - Добавление колонки "потерянные" в таблицу "Свод_по_заметкам"
  - Автоматическое создание колонки если не существует

- **Новый модуль `excel_manager.py`**
  - `get_user_date()` - запрос даты у пользователя
  - `filter_problems_by_date()` - фильтрация проблем по дате
  - `calculate_time_window_for_date()` - вычисление временного окна для даты
  - `save_results_to_excel()` - сохранение в Excel файл

### Изменено
- **`main.py`**
  - Добавлены новые флаги `--date-filter` и `--save-to-excel`
  - Добавлена логика переключения между режимами работы
  - Сохранен полный исходный функционал

### Совместимость
- ✅ Полная обратная совместимость
- ✅ Исходный функционал работает без изменений
- ✅ Новый функционал доступен только по флагам

### Примеры использования

#### Стандартный режим (без изменений)
```bash
python main.py data.xlsx --out-csv results.csv
```

#### Новый режим с фильтрацией по дате
```bash
python main.py data.xlsx --date-filter
```

#### Новый режим с сохранением в Excel
```bash
python main.py data.xlsx --date-filter --save-to-excel
```

### Файлы
- `modules/excel_manager.py` - новый модуль
- `main.py` - обновлен с новыми флагами
- `README_NEW_FEATURES.md` - документация нового функционала
- `test_new_functionality.py` - тестовый скрипт
- `CHANGELOG.md` - этот файл