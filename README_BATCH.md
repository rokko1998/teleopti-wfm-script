# WFM Traffic Script - Инструкция по запуску

## Быстрый старт

### 1. Первоначальная настройка (один раз)
Запустите `setup.bat` для создания виртуального окружения и установки зависимостей:
```batch
setup.bat
```

### 2. Запуск скрипта
После настройки запустите скрипт командой:
```batch
run_script.bat
```

## Что делает батник

### setup.bat
- Проверяет наличие Python
- Создает виртуальное окружение `venv`
- Устанавливает все необходимые зависимости из `requirements.txt`
- Обновляет pip до последней версии

### run_script.bat
- Проверяет наличие виртуального окружения (создает если нет)
- Активирует виртуальное окружение
- Устанавливает/обновляет зависимости
- Запускает скрипт: `python main.py test08.xlsx --auto-date-processing`
- Показывает результат выполнения

## Новые возможности

### Индикатор прогресса
Скрипт теперь показывает:
- **Полосу загрузки** с текущим прогрессом
- **Количество обработанных строк** из общего количества
- **Оставшееся время** выполнения
- **Скорость обработки** (строк в секунду)
- **Текущую обрабатываемую строку** (номер массовой и регион)

### Пример вывода:
```
Обработка: 12345 (Москва): 100%|██████████| 25/25 [02:15<00:00,  0.19строка/s]
```

## Требования

- **Python 3.8+** должен быть установлен и добавлен в PATH
- **Файл test08.xlsx** должен находиться в папке со скриптом
- **Файл region_skills.yml** должен быть настроен

## Устранение проблем

### Ошибка "Python не найден"
1. Установите Python с https://python.org
2. При установке отметьте "Add Python to PATH"
3. Перезапустите командную строку

### Ошибка "Виртуальное окружение не найдено"
Запустите `setup.bat` для создания окружения

### Ошибка "Файл заблокирован"
Закройте файл `test08.xlsx` в Excel перед запуском скрипта

### Ошибка доступа к файлу
Убедитесь, что:
- Файл `test08.xlsx` не открыт в Excel
- У вас есть права на запись в папку
- Антивирус не блокирует скрипт

## Ручной запуск

Если батник не работает, запустите вручную:

```batch
# Создание окружения
python -m venv venv

# Активация
venv\Scripts\activate.bat

# Установка зависимостей
pip install -r requirements.txt

# Запуск скрипта
python main.py test08.xlsx --auto-date-processing
```

## Логи

Все логи сохраняются в консоль с цветной подсветкой. При ошибках показывается подробная информация для диагностики.
